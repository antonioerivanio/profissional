<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition template="../../WEB-INF/templates/page.xhtml"
	  xmlns="http://www.w3.org/1999/xhtml"      
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
 	  xmlns:c="http://java.sun.com/jsp/jstl/core"
 	  xmlns:a4j="http://richfaces.org/a4j"
 	  xmlns:rich="http://richfaces.org/rich"
 	  xmlns:t="http://myfaces.apache.org/tomahawk" >

	<ui:define name="content">

		<style>
		    .formularios fieldset,
		    .box-border {
		        border: 1px solid #c6c6c6;
		        padding: 15px 15px 0px 15px;
		        padding-right: 0;
		        overflow: auto;
		        margin-bottom: 10px;
		        min-height: 100px;
		    }
		</style>

		<script>
		function openwindow()
		{
			nome = document.getElementById('form:nomeCompletoPessoa').value;
			if (nome.length > 2) {
				window.open("/srh/paginas/funcional/funcionalConsulta.faces?nome=" + nome,"mywindow","menubar=0,resizable=0,width=800,height=300");
			} else {
				alert('Digite pelo menos 3 caracteres para a pesquisa');
			}
		}

		</script>

		<div class="titulo-pagina">

			<h2>Lançamento de Periodo de Licença</h2>

		</div>
		
         <h:form id="form" styleClass="formularios">

			<fieldset>

			<legend>Funcionário</legend>

			<br/>

            <h:messages id="messages" infoClass="infoMessage" errorClass="errorMessage" />

			<div class="input-box box-10">
				<label for="">Matricula</label>
				<div class="conteiner">
					<h:inputText id="matricula" 
								 name="matricula"
								 maxlength="6"
								 styleClass="maskMatricula"
								 value="#{licencaFormBean.matricula}" >
						<a4j:support event="onchange"
									 focus="processo"
									 reRender="messages, nomeCompletoPessoa, mae, cpf, rg, rgEmissor, rgUf"
									 ajaxSingle="true" />
					</h:inputText>
				</div>
			</div>

			<div class="input-box box-75">
				<label for="">Nome</label>
				<div class="conteiner">
					<h:inputText id="nomeCompletoPessoa"
								 name="nomeCompletoPessoa"
								 value="#{licencaFormBean.nome}" />
				</div>
			</div>

			<a id="form:Pesquisar" 
			   href="#" 
			   onclick="openwindow()" 
			   class="bt-padrao fl mg-top-18">Pesquisar</a>

			<div class="input-box box-100">
				<label for="">Mãe</label>
				<div class="conteiner">
					<h:inputText id="mae"
								 name="mae"
								 disabled="true"
								 value="#{licencaFormBean.entidade.pessoal.nomeMae}" />
				</div>
			</div>


			<div class="input-box box-25">
				<label for="">CPF</label>
				<div class="conteiner">
					<h:inputText id="cpf" 
								 maxlength="14"
								 styleClass="maskCpf"
								 disabled="true"
								 converter="cpfConverter"
								 value="#{licencaFormBean.entidade.pessoal.cpf}" />
				</div>
			</div>

			<div class="input-box box-25">
				<label for="">RG</label>
				<div class="conteiner">
					<h:inputText id="rg" 
								 maxlength="15"
								 disabled="true"
								 value="#{licencaFormBean.entidade.pessoal.rg}" />
				</div>
			</div>

			<div class="input-box box-25">
				<label for="">Emissor</label>
				<div class="conteiner">
					<h:inputText id="rgEmissor" 
								 maxlength="10"
								 disabled="true"
								 value="#{licencaFormBean.entidade.pessoal.emissorRg}" />
				</div>
			</div>

			<div class="input-box box-25">
				<label for="">UF</label>
				<div class="conteiner">
					<h:inputText id="rgUf" 
								 maxlength="2"
								 disabled="true"
								 value="#{licencaFormBean.entidade.pessoal.ufEmissorRg.id}" />
				</div>
			</div>

			</fieldset>

			

			<!-- Licença -->
			<fieldset>

				<legend>Licença</legend>

				<br/>

				<div class="input-box box-15">
					<label for="">Processo</label>
					<div class="conteiner">
						<h:inputText id="processo" styleClass="maskProcesso" maxlength="10"
									 value="#{licencaFormBean.nrProcesso}" >
						<a4j:support event="onchange" focus="tipoLicenca" reRender="messages" ajaxSingle="true" />
						</h:inputText>
					</div>
				</div>

				<div class="select-box box-37">
					<label for="">Tipo de Licença *</label>
					<div class="conteiner">
						<h:selectOneMenu id="tipoLicenca"
										 value="#{licencaFormBean.entidade.tipoLicenca}"
										 required="true"
										 requiredMessage="O tipo de licença é obrigatório."
										 converter="entityConverter"
										 onmousemove="validarPessoa()" >
						  	<f:selectItem id="selecioneTipoLicenca" itemLabel="Selecione..." itemValue="" />
						  	<f:selectItems 	id="comboTipoLicenca" 
						  					value="#{licencaFormBean.comboTipoLicenca}"
						  					var="tipoLicenca"
						  					itemValue="#{tipoLicenca}"
						  					itemLabel="#{tipoLicenca.descricao}" />
				  			<a4j:support id="carregaLicencaEspecial"
					  				 event="onchange" 
					  				 ajaxSingle="true"	
					  				 action="#{licencaFormBean.carregaLicencaEspecial}"
					  				 reRender="licencaEspecial"/>
						</h:selectOneMenu>
					</div>
				</div>

				<!--  incluir -->
				<h:panelGroup>

					<div class="select-box box-37">
						<label for="">Licença Especial</label>
						<div class="conteiner">
							<h:selectOneMenu id="licencaEspecial"
											 converter="entityConverter"
									 		 value="#{licencaFormBean.entidade.licencaEspecial}"
									 		 disabled="#{not licencaFormBean.exibirComboLicencaEspecial}">
							  	<f:selectItem id="selecionelicencaEspecial" itemLabel="Selecione..." itemValue="" />
							  	<f:selectItems 	id="combolicencaEspecial" 
							  					value="#{licencaFormBean.comboLicencaEspecial}"
							  					var="licencaEspecial"
							  					itemValue="#{licencaEspecial}"
							  					itemLabel="Período: #{licencaEspecial.anoinicial} / #{licencaEspecial.anofinal}  - Saldo em Dias: #{licencaEspecial.saldodias}"/>
							</h:selectOneMenu>
						</div>
					</div>

				</h:panelGroup>

				<br/><br/><br/><br/><br/>

				<div class="input-box box-15">
					<label for="">Data Inicial *</label>
					<div class="conteiner">
						<h:inputText id="periodoInicial" 
									 styleClass="maskData" 
									 converter="dateConverter"
									 required="true"
									 requiredMessage="O período inicial é obrigatório."
									 value="#{licencaFormBean.entidade.inicio}"
									 maxlength="10" /> 
					</div>
				</div>

				<div class="input-box box-15">
					<label for="">Data Final *</label>
					<div class="conteiner">
						<h:inputText id="periodoFinal" 
									 styleClass="maskData"
									 converter="dateConverter"
									 required="true"
									 requiredMessage="O período final é obrigatório."
									 value="#{licencaFormBean.entidade.fim}"
									 maxlength="10" /> 
					</div>
				</div>

				<div class="select-box box-15">
					<label for="">Tipo de Publicação </label>
					<div class="conteiner">
						<h:selectOneMenu id="tipoPublicacao"
										 converter="entityConverter" 
										 value="#{licencaFormBean.entidade.tipoPublicacao}">
							<f:selectItem id="selecioneTipoPublicacao" itemLabel="Selecione..." itemValue="" />
						   	<f:selectItems 	id="comboTipoPublicacao" 
						   					value="#{licencaFormBean.comboTipoPublicacao}"
						   					var="tipoPublicacao"
						   					itemValue="#{tipoPublicacao}"
						   					itemLabel="#{tipoPublicacao.descricao}"/>
						</h:selectOneMenu>
					</div>
				</div>

				<div class="input-box box-15">
					<label for="">Publicação </label>
					<div class="conteiner">
						<h:inputText id="publicacao" 
									 styleClass="maskData" 
									 converter="dateConverter"
									 value="#{licencaFormBean.entidade.doe}"
									 maxlength="10" /> 
					</div>
				</div>
				
				<div class="radios-group box-15">
					<label>Excluir Tempo  de Serviço </label>
					<div class="conteiner">
						<div class="radio-box">
							<h:selectBooleanCheckbox id="delTempoServico"
													 value="#{licencaFormBean.entidade.excluitemposerv}" />
						</div>
					</div>
				</div>
				
				<div class="radios-group box-15">
					<label>Excluir Retribuição Financeira </label>
					<div class="conteiner">
						<div class="radio-box">
							<h:selectBooleanCheckbox id="delRetribuicaoFin"
													 value="#{licencaFormBean.entidade.excluifinanceiro}" />
						</div>
					</div>
				</div>

				<div class="textarea-box box-100">
					<label for="">Observação</label>
					<div class="conteiner">
						<h:inputTextarea id="observacao"
										 value="#{licencaFormBean.entidade.obs}"
										 onkeyup="this.value = this.value.substring(0, 99);" />
					</div>
				</div>

			</fieldset>
	
			<h:commandButton action="#{licencaFormBean.salvar}" value="Salvar" styleClass="bt-padrao fr" onclick="return validarLicenca()" />
			<h:commandButton value="Voltar" styleClass="bt-voltar fr mg-right-10" action="/paginas/funcional/licencaList.faces" immediate="true">
				<f:setPropertyActionListener target="#{licencaListBean.passouConsultar}" value="true"/>
			</h:commandButton>			
			<a href="/srh/paginas/funcional/licencaForm.faces" class="bt-voltar fr mg-right-10">Limpar</a>

		</h:form>

	</ui:define>
</ui:composition>
