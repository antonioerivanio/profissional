<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">

	<!-- Esta pagina contém os campos comuns ao cadastro do Titular e Dependentes -->
	<fieldset>
		<legend>#{title}</legend>

		<ui:fragment style="width: 100%; margin-bottom: 15px;"
			rendered="#{not isBeneficiario}">
			<div class="select-box box-100">
				<label for=""> Nome do dependente </label>

				<div class="conteiner">
					<h:selectOneMenu converter="entityConverter"
						onchange="exibirCamposDependentes()"
						value="#{auxilioSaudeFormBean.entidade.dependenteSelecionado}">
						<f:selectItem itemLabel="Selecione..." />
						<f:selectItems
							value="#{auxilioSaudeFormBean.entidade.dependentesComboList}"
							var="beanDep" itemValue="#{beanDep}"
							itemLabel="#{beanDep.dependente.nomeCompleto}" />
						<a4j:ajax execute="@this"></a4j:ajax>
					</h:selectOneMenu>
				</div>
			</div>
		</ui:fragment>

		<ui:fragment style="width: 100%; margin-bottom: 15px;">
			<div class="tabela-dados-dependentes">
				<div class="input-box box-20 ">
					<label for="asCadValorPlano">Valor Mensal R$: *</label>

					<div class="conteiner">
						<h:inputText
							value="#{auxilioSaudeFormBean.entidade.valorGastoPlanoSaude}"
							maxlength="20" styleClass="maskSalario">
							<f:convertNumber type="currency" currencySymbol="R$"
								locale="pt_br" />
						</h:inputText>
					</div>
				</div>

				<div class="select-box box-30">
					<label for="">Nome Empresa Plano Saúde * </label>

					<div class="conteiner">
						<h:selectOneMenu
							value="#{auxilioSaudeFormBean.entidade.pessoaJuridica}"
							converter="entityConverter">
							<f:selectItem itemLabel="Selecione..." itemValue="" />
							<f:selectItems
								value="#{auxilioSaudeFormBean.comboEmpresasCadastradas}"
								var="orgaoOrigem" itemValue="#{orgaoOrigem}"
								itemLabel="#{orgaoOrigem.nomeFantasia} - #{orgaoOrigem.razaoSocial}" />
							<a4j:ajax execute="@this"></a4j:ajax>
						</h:selectOneMenu>
					</div>
				</div>

				<h:panelGroup>

					<ui:fragment
						rendered="#{LoginBean.anyGranted('ROLE_FOLGA_INSERIR,ROLE_FOLGA_ALTERAR')}">
						<rich:fileUpload styleClass="fileUploadFicha"
							style="display: none; padding-rigth:10px"
							fileUploadListener="#{folgaFormBean.uploadComprovante}"
							acceptedTypes="pdf"
							ontyperejected="alerta('Somente arquivos PDF são aceitos.');"
							maxFilesQuantity="1" immediateUpload="true"
							onsizerejected="alerta('O tamanho do arquivo excedeu o limite do sistema.');">
							<a4j:ajax event="uploadcomplete" execute="@none"
								render="form:fileUpload, form:comprovanteFolga, messages" />
						</rich:fileUpload>

						<h:commandLink id="bntAnexoDep#{id}" class="bt-upload fl mg-top-14"
							onclick="document.querySelector('.fileUploadFicha input').click()"
							value="Anexar"></h:commandLink>

						<!-- Exibe informações do botão Novo quando usuário passar o mouse sobre ele -->
						<rich:tooltip styleClass="tooltip" layout="block"
							target="bntAnexoDep#{id}">
							<span style="white-space: nowrap"> <strong>
									Anexar documentação comprobatória</strong>
							</span>
						</rich:tooltip>
					</ui:fragment>

					<h:commandLink styleClass="link-arquivo"
						value="Clique aqui para visualizar"
						action="#{folgaFormBean.comprovanteFolga}" target="_blank"
						rendered="#{folgaFormBean.entidade.caminhoComprovante != null}" />

					<h:commandButton
						actionListener="#{auxilioSaudeFormBean.adicionarDadosBeneficiario(auxilioSaudeFormBean.entidade, isBeneficiario)}"
						value="Adicionar" styleClass="bt-padrao fl mg-top-14 mg-left-10"
						style="padding:10px;">
						<a4j:ajax execute="dados#{id} select_#{id}"
							render="listaBenef_#{id} listaDep_#{id}"></a4j:ajax>
					</h:commandButton>

				</h:panelGroup>
				<div class="tabela-dados">

					<rich:dataTable id="listaDep_#{id}" var="item"
						rendered="#{!isBeneficiario}"
						rows="#{auxilioSaudeFormBean.entidade.auxilioSaudeRequisicaoDependenteList.size()}"
						value="#{auxilioSaudeFormBean.entidade.auxilioSaudeRequisicaoDependenteList}">

						<h:column>
							<f:facet name="header">
		                            NOME DA EMPRESA DO PLANO DE SAÚDE
		                        </f:facet>

							<h:outputText value="#{item.pessoaJuridica.nomeFantasia}" />
						</h:column>

						<h:column>
							<f:facet name="header">
		                            Valor Gasto (R$)
		                        </f:facet>

							<h:outputText value="#{item.valorGastoPlanoSaude}" />
						</h:column>

						<h:column>
							<center>
								<f:facet name="header">
		                          Anexos
		                        </f:facet>

								<h:outputLink actionListener="#{auxilioSaudeFormBean.adicionar}">
									<h:graphicImage url="/img/attached.png"
										style="cursor: pointer; width: 24px;height: 24px;"></h:graphicImage>
								</h:outputLink>
							</center>
						</h:column>

					</rich:dataTable>
				</div>


			</div>


		</ui:fragment>

	</fieldset>

</ui:composition>
