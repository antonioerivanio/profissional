<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition template="../../WEB-INF/templates/page.xhtml"
	  xmlns="http://www.w3.org/1999/xhtml"     
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
 	  xmlns:c="http://java.sun.com/jsp/jstl/core"
 	  xmlns:rich="http://richfaces.org/rich"
 	  xmlns:a4j="http://richfaces.org/a4j" >

	<ui:define name="content">

		<div class="titulo-pagina">

			<h2>Funcionário por Competência e Área</h2>

		</div>

		<h:form id="form" styleClass="formularios box-border">

			<h:messages infoClass="infoMessage" errorClass="errorMessage" />

			<div class="select-box box-25">
				<label for="">Setor</label>
				<div class="conteiner">
					<h:selectOneMenu id="setor"
									 value="#{funcionarioCompetenciaSetorListBean.setor}"
									 converter="entityConverter">
						<f:selectItem id="selecioneSetor" itemLabel="Selecione..." itemValue="" />
					  	<f:selectItems 	id="comboSetor" 
					  					value="#{funcionarioCompetenciaSetorListBean.comboSetor}"
					  					var="setor"
					  					itemValue="#{setor}"
					  					itemLabel="#{setor.nome}"/>
					  	<a4j:ajax event="change" 
					  				 execute="@this"
					  				 listener="#{funcionarioCompetenciaSetorListBean.carregaArea}"
					  				 render="area,competencia,lista"/>
					</h:selectOneMenu>
				</div>
			</div>

			<div class="select-box box-25">
				<label for="">Área</label>
				<div class="conteiner">
					<h:selectOneMenu id="area"
									 value="#{funcionarioCompetenciaSetorListBean.areaSetor}"
									 converter="entityConverter" >
						<f:selectItem id="selecioneArea" itemLabel="Selecione..." itemValue="" />
					  	<f:selectItems 	id="comboArea" 
					  					value="#{funcionarioCompetenciaSetorListBean.comboArea}"
					  					var="area"
					  					itemValue="#{area}"
					  					itemLabel="#{area.descricao}"/>
					</h:selectOneMenu>
				</div>
			</div>

			<div class="input-box box-10">
				<label for="">Inicial</label>
				<div class="conteiner">
					<h:inputText id="dataInicio" 
								 name="dataInicio"
								 styleClass="maskData" 
								 converter="dateConverter"
								 value="#{funcionarioCompetenciaSetorListBean.dataInicio}" 
								 maxlength="10" />
				</div>
			</div>

			<div class="input-box box-10">
				<label for="">Final</label>
				<div class="conteiner">
					<h:inputText id="dataFinal" 
								 name="dataInicio"
								 styleClass="maskData" 
								 converter="dateConverter"
								 value="#{funcionarioCompetenciaSetorListBean.dataFinal}" 
								 maxlength="10" />
				</div>
			</div>

			<h:commandButton id="consultar"
							 value="Consultar"
							 action="#{funcionarioCompetenciaSetorListBean.consultar}"
							 styleClass="bt-padrao fl mg-top-18" />
			

			<div class="tabela-dados">

				<rich:dataTable id="lista" value="#{funcionarioCompetenciaSetorListBean.listaServidorCompetencia}" var="item" >

					<f:facet name="header">
						<rich:columnGroup>

							<rich:column colspan="1">
								<h:outputText value="STATUS" />
							</rich:column>
							
							<rich:column colspan="1">
								<h:outputText value="NOME" />
							</rich:column>
							
							<rich:column>
								<h:outputText value="TIPO" />
							</rich:column>
						
						</rich:columnGroup>
					</f:facet>

					<rich:column colspan="3">
						<h:outputText
							value="#{item.areaSetorCompetencia.competencia.descricao}" />
					</rich:column>

					<rich:collapsibleSubTable var="expense" value="#{item}">
					
						<rich:column>
							<center>
								<h:graphicImage value="/img/accept3.gif" rendered="#{item.img}" />
							</center>
							
							<center>
								<h:graphicImage value="/img/cacel3.png" rendered="#{not item.img}" />
							</center>
						</rich:column>

					 	<rich:column>
							<h:outputText value="#{expense.pessoal.nomeCompleto}">
							</h:outputText>
						</rich:column>  

						<rich:column style="text-align:center">
							<h:commandLink id="tipo" value="#{item.validaCompetencia}"
								action="#{funcionarioCompetenciaSetorFormBean.visualizar}" >
								<f:setPropertyActionListener
									target="#{funcionarioCompetenciaSetorFormBean.servidorCompetencia}"
									value="#{item}" />
							</h:commandLink>
						</rich:column>
						
					</rich:collapsibleSubTable>

				</rich:dataTable>

			</div>
			
			<h:commandButton id="limpaTela"
							 value="Limpar"
							 action="#{funcionarioCompetenciaSetorListBean.limpaTela}"
							 styleClass="bt-padrao fr mg-right-15" 
							 />	

		</h:form>
	</ui:define>
</ui:composition>
