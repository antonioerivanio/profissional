<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="../../WEB-INF/templates/page.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

	<ui:define name="content">

		<style>
			.formularios fieldset, .box-border {
				border: 1px solid #c6c6c6;
				padding: 15px 15px 0px 15px;
				padding-right: 0;
				overflow: auto;
				margin-bottom: 10px;
				min-height: 100px;
			}
			
			.formularios fieldset fieldset {
				min-height: auto;
				width: max-content;
			}
		</style>

		<div class="titulo-pagina">

			<h2>Cadastro de Estabelecimento</h2>

		</div>

		<h:form id="form" styleClass="formularios">			
		
			<ui:include src="../../WEB-INF/templates/esocial-legenda.xhtml" />

			<fieldset>
			
				<h:messages id="messages" infoClass="infoMessage" errorClass="errorMessage" />
								
				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações de identificação" />
                </ui:include>								

				<div class="input-box box-10">
					<label for="">ID <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText disabled="true" value="#{estabelecimentoFormBean.entidade.id}" />
					</div>
				</div>
				
				<div class="select-box box-20">
					<label for="">Tipo de inscrição * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu 
							id="tpInsc"
							value="#{estabelecimentoFormBean.entidade.tipoInscricao}" 
							required="true"
							requiredMessage="O tipo de inscrição é obrigatório.">
							<f:selectItem id="selecioneTpInsc" itemLabel="Selecione..." />
							<f:selectItems 
								id="comboTipoInscricao"
								value="#{estabelecimentoFormBean.comboTipoInscricao}" 
								var="tipoInscricao"
								itemLabel="#{tipoInscricao}" 
								itemValue="#{tipoInscricao}" />
						</h:selectOneMenu>
					</div>
				</div>
				

				<div class="input-box box-20">
					<label for="">Número de inscrição * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText 
							id="nrInsc" 
							value="#{estabelecimentoFormBean.entidade.numeroInscricao}" 
							maxlength="15"
							required="true" 
							requiredMessage="O número de inscrição é obrigatório."
							onkeyup="mantemSomenteNumeros(this)" />
					</div>
				</div>
				
				<ui:include src="../../WEB-INF/templates/esocial-vigencia.xhtml">
                    <ui:param name="vigencia" value="#{estabelecimentoFormBean.entidade.esocialVigencia}" />
                </ui:include>

				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações do Estabelecimento" />
                </ui:include>

				<div class="input-box box-15">
					<label for="">Código <br />do CNAE * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText 
							id="cnaePrep"
							value="#{estabelecimentoFormBean.entidade.cnae}" 
							maxlength="7"
							required="true" 
							requiredMessage="O código do CNAE é obrigatório."
							onkeyup="mantemSomenteNumeros(this)" />
					</div>
				</div>
				
				<div class="select-box box-15">
					<label for="">Alíquota <br />RAT * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu 
							id="aliqRat"
							value="#{estabelecimentoFormBean.entidade.rat}" 
							required="true"
							requiredMessage="A alíquota RAT é obrigatória.">
							<f:selectItem id="aliqRatSelecione" itemLabel="Selecione..." />
							<f:selectItem id="aliqRat1" itemLabel="1%" itemValue="1" />
							<f:selectItem id="aliqRat2" itemLabel="2%" itemValue="2"/>
							<f:selectItem id="aliqRat3" itemLabel="3%" itemValue="3"/>
							<a4j:support 
								event="onchange" 
								action="#{estabelecimentoFormBean.entidade.atualizaAliqRatAjust}" 
								reRender="aliqRatAjust" 
								ajaxSlingle="true" />
						</h:selectOneMenu>
					</div>
				</div>
				
				<div class="input-box box-15">
					<label for="">Fator Acidentário <br />de Prevenção - FAP * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText 
							id="fap"
							value="#{estabelecimentoFormBean.entidade.fap}"							
							required="true" 
							requiredMessage="O FAP é obrigatório."
							styleClass="maskFap"
							>
							<f:convertNumber type="number" maxFractionDigits="4" maxIntegerDigits="1" locale="pt_br"/>
							<a4j:support 
								event="onblur" 
								action="#{estabelecimentoFormBean.entidade.atualizaAliqRatAjust}" 
								reRender="aliqRatAjust" 
								ajaxSlingle="true" />
						</h:inputText>	
					</div>
				</div>
				
				<div class="input-box box-15">
					<label for="">Alíquota do RAT <br />após ajuste pelo FAP * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText 
							id="aliqRatAjust"
							value="#{estabelecimentoFormBean.entidade.ratAjustado}"
							styleClass="maskFap"
							disabled="true">
							<f:convertNumber type="number" maxFractionDigits="4" maxIntegerDigits="1" locale="pt_br"/>
						</h:inputText>	
					</div>
				</div>
				
				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações trabalhistas" />
                </ui:include>
				
				<div class="select-box box-35">
					<label for="">Opção de registro de ponto <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu 
							id="regPt"
							value="#{estabelecimentoFormBean.entidade.registroPonto}" >
							<f:selectItem id="selecioneRegPt" itemLabel="Selecione..." />
							<f:selectItems 
								id="comboRegPt"
								value="#{estabelecimentoFormBean.comboRegistroPonto}" 
								var="ponto"
								itemLabel="#{ponto.codigo} - #{ponto.descricao}" 
								itemValue="#{ponto}" />
						</h:selectOneMenu>
					</div>
				</div>
				
				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações relacionadas à contratação de aprendiz" />
                </ui:include>
				
				<div class="select-box box-35">
					<label for="">Indicativo de contratação de aprendiz * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu 
							id="contApr"
							value="#{estabelecimentoFormBean.entidade.aprendizContrato}" 
							required="true"
							requiredMessage="O indicativo de contratação de aprendiz é obrigatório.">
							<f:selectItem id="selecioneContApr" itemLabel="Selecione..." />
							<f:selectItems 
								id="comboContApr"
								value="#{estabelecimentoFormBean.comboAprendizContrato}" 
								var="aprendiz"
								itemLabel="#{aprendiz.codigo} - #{aprendiz.descricao}" 
								itemValue="#{aprendiz}" />
						</h:selectOneMenu>
					</div>
				</div>
				
				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações sobre a contratação de pessoa com deficiência (PCD)" />
                </ui:include>				
				
				
				<div class="select-box box-35">
					<label for="">Indicativo de contratação de PCD * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu 
							id="contPCD"
							value="#{estabelecimentoFormBean.entidade.pcdContrato}" 
							required="true"
							requiredMessage="O indicativo de contratação de PCD é obrigatório.">
							<f:selectItem id="selecioneContPCD" itemLabel="Selecione..." />
							<f:selectItems 
								id="comboContPCD"
								value="#{estabelecimentoFormBean.comboPcdContrato}" 
								var="pdc"
								itemLabel="#{pdc.codigo} - #{pdc.descricao}" 
								itemValue="#{pdc}" />
						</h:selectOneMenu>
					</div>
				</div>			
				

			</fieldset>
			
			<h:commandButton value="Salvar" action="#{estabelecimentoFormBean.salvar}" styleClass="bt-padrao fr" rendered="#{true}"/>			

			<a href="/srh/paginas/tabelas/estabelecimentoList.faces" class="bt-padrao fr mg-right-10">Voltar</a>

		</h:form>

	</ui:define>
</ui:composition>
