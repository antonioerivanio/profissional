<?xml version="1.0" encoding="UTF-8"?>
<ui:composition template="../../WEB-INF/templates/page.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

	<ui:define name="content">

		<style>
			.formularios fieldset, .box-border {
				border: 1px solid #c6c6c6;
				padding: 15px 15px 0px 15px;
				padding-right: 0;
				overflow: auto;
				margin-bottom: 10px;
				min-height: 100px;
			}
			
			.formularios fieldset fieldset {
				min-height: auto;
				width: max-content;
			}
		</style>

		<script>
			jQuery(document).ready(function($) {
				contarCaracteres();
			});
			function contarCaracteres() {
				document.getElementById('countChar').innerHTML = 'Quantidade de caracteres: '
						+ (document.getElementById('form:observacao').value.length) + ' / 255';
			}
		</script>

		<div class="titulo-pagina">

			<h2>Cadastro de Processo</h2>

		</div>

		<h:form id="form" styleClass="formularios">

			<fieldset style="padding-right: 15px">
			
				<ui:include src="../../WEB-INF/templates/esocial-legenda.xhtml" />

				<h:messages id="messages" infoClass="infoMessage" errorClass="errorMessage" />

				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações de identificação" />
                </ui:include>
				
				<div class="input-box box-10">
					<label for="">ID</label>
					<div class="conteiner">
						<h:inputText disabled="true"
							value="#{processoESocialFormBean.entidade.id}" />
					</div>
				</div>

				<div class="select-box box-25">
					<label for="">Tipo de Processo * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu id="tipoProcesso"
							value="#{processoESocialFormBean.entidade.tipoProcesso}"
							required="true"
							requiredMessage="O Tipo de Processo é obrigatório.">
							<f:selectItem id="selecioneTipoProcesso" itemLabel="Selecione..." />
							<f:selectItems id="comboTipoProcesso"
								value="#{processoESocialFormBean.comboTipoProcesso}" var="tipo"
								itemLabel="#{tipo.codigo} - #{tipo.descricao}" itemValue="#{tipo}" />
						</h:selectOneMenu>
					</div>
				</div>

				<div class="input-box box-15">
					<label for="">Número * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText id="numero"
							value="#{processoESocialFormBean.entidade.numero}" maxlength="21"
							required="true"
							requiredMessage="O Número do Processo é obrigatório." />
					</div>
				</div>
				
				<ui:include src="../../WEB-INF/templates/esocial-vigencia.xhtml">
                    <ui:param name="vigencia" value="#{processoESocialFormBean.entidade.esocialVigencia}" />
                </ui:include>
                
                <ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Dados do processo" />
                </ui:include>

				<div class="select-box box-50">
					<label for="">Indicativo Autoria  <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu id="indicativoAutoria"
							value="#{processoESocialFormBean.entidade.indicativoAutoria}">
							<f:selectItem id="selecioneIndicativoAutoria"
								itemLabel="Selecione..." />
							<f:selectItems id="comboIndicativoAutoria"
								value="#{processoESocialFormBean.comboIndicativoAutoria}"
								var="autoria" itemLabel="#{autoria.codigo} - #{autoria.descricao}"
								itemValue="#{autoria}" />
						</h:selectOneMenu>
					</div>
				</div>

				<div class="select-box box-50">
					<label for="">Indicativo Matéria * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu id="indicativoMateria"
							value="#{processoESocialFormBean.entidade.indicativoMateria}"
							required="true"
							requiredMessage="O Indicativo de Matéria é obrigatório.">
							<f:selectItem id="selecioneIndicativoMateria"
								itemLabel="Selecione..." />
							<f:selectItems id="comboIndicativoMateria"
								value="#{processoESocialFormBean.comboIndicativoMateria}"
								var="materia" itemLabel="#{materia.codigo} - #{materia.descricao}"
								itemValue="#{materia}" />
						</h:selectOneMenu>
					</div>
				</div>

				<div class="textarea-box box-100">
					<label for="">Observação <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner" style="margin-right: 0">
						<h:inputTextarea id="observacao"
							value="#{processoESocialFormBean.entidade.observacao}"
							validatorMessage="O campo Observação excedeu o tamanho máximo de 255 caracteres"
							onkeyup="contarCaracteres();">
							<f:validateLength maximum="255" />
						</h:inputTextarea>
					</div>
						<label id="countChar" style="margin-top: 2px; font-size: 11px;"></label>
				</div>

				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações complementares" />
                </ui:include>

				<div class="select-box box-15">
					<label for="">UF * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu id="uf" converter="entityConverter"
							value="#{processoESocialFormBean.uf}">
							<f:selectItem id="selecioneUf" itemLabel="Selecione..." />
							<f:selectItems id="comboUf" required="true"
								requiredMessage="O UF é obrigatório."
								value="#{processoESocialFormBean.comboUf}" var="uf"
								itemValue="#{uf}" itemLabel="#{uf.id}" />
							<a4j:support id="comboUfAction" event="onchange"
								reRender="municipio" ajaxSingle="true"/>
						</h:selectOneMenu>
					</div>
				</div>

				<div class="select-box box-35">
					<label for="">Município * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu id="municipio" converter="entityConverter"
							value="#{processoESocialFormBean.entidade.municipioVara}">
							<f:selectItem id="selecioneMunicipio" itemLabel="Selecione..." />
							<f:selectItems id="comboMunicipio" required="true"
								requiredMessage="O município é obrigatório."
								value="#{processoESocialFormBean.comboMunicipio}"
								var="municipio" itemValue="#{municipio}"
								itemLabel="#{municipio.codigoIBGE} - #{municipio.nome}" />
						</h:selectOneMenu>
					</div>
				</div>

				<div class="input-box box-20">
					<label for="">ID Vara * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText id="nome" required="true"
								requiredMessage="O id vara é obrigatório."
							value="#{processoESocialFormBean.entidade.idVara}" maxlength="4"
							onkeyup="mantemSomenteNumeros(this)" />
					</div>
				</div>

				<ui:include src="../../WEB-INF/templates/subtitulo.xhtml">
                    <ui:param name="subtitulo" value="Informações de Suspensão de Exigibilidade" />
                </ui:include>
				
								
				<div class="select-box box-40">
					<label for="">Indicativo de suspensão da exigibilidade * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:selectOneMenu id="indicativoSuspensao" required="true"
								requiredMessage="O Indicativo de suspensão da exigibilidade é obrigatório."
							value="#{processoESocialFormBean.novaSuspensao.indicativoSuspensao}">
							<f:selectItem id="selecioneIndicativoSuspensao" itemLabel="Selecione..." />
							<f:selectItems id="comboIndicativoSuspensao" 
								value="#{processoESocialFormBean.comboIndicativoSuspensao}"
								var="suspensao" itemLabel="#{suspensao.codigo} - #{suspensao.descricao}"
								itemValue="#{suspensao}" />
						</h:selectOneMenu>
					</div>
				</div>
				
				<div class="input-box box-15">
					<label for="">Data da decisão * <span class="identificador-esocial">(e)</span></label>
					<div class="conteiner">
						<h:inputText id="dataDecisao" name="dataDecisao" styleClass="maskData"
							converter="dateConverter"
							value="#{processoESocialFormBean.novaSuspensao.dataDecisao}"
							maxlength="10" required="true"
							requiredMessage="O Data da decisão é obrigatório." />
					</div>
				</div>
				
				<div class="radios-group box-30">
					<h3>Indicativo de depósito do montante integral * <span class="identificador-esocial">(e)</span></h3>
					<div class="conteiner">
						<div class="radio-box">
						<h:selectOneRadio id="indicativoDeposito" value="#{processoESocialFormBean.novaSuspensao.indicativoDeposito}">
							<f:selectItems id="simNao"  required="true"
								requiredMessage="O Indicativo de depósito do montante integral é obrigatório."
								value="#{processoESocialFormBean.simNao}" 
								var="item" itemLabel="#{item.descricao}" itemValue="#{item}" />
						</h:selectOneRadio>
						</div>
					</div>
				</div>
				
				<h:commandButton value="Adicionar" action="#{processoESocialFormBean.incluirSuspensao}" styleClass="bt-padrao" style="margin-top: 44px;" >
					<a4j:support id="btAdicionarSuspensao" 
				  	             event="onclick"
				  	             reRender="indicativoSuspensao, dataDecisao, indicativoDeposito, listaSuspensoes" />
				</h:commandButton>
				
				
				<div class="tabela-dados">
					<rich:dataTable id="listaSuspensoes" var="suspensao" value="#{processoESocialFormBean.entidade.suspensoesAtualizadas}">		
						<h:column id="col1" headerClass="cel-15">
							<f:facet name="header">
	                           ID
	                        </f:facet>
							<center>
								<h:outputText id="suspensaoId" value="#{suspensao.id}" styleClass="cel-15" />
							</center>
						</h:column>		
						<h:column id="col2" headerClass="cel-50">
							<f:facet name="header">
	                           Indicativo de suspensão
	                        </f:facet>
							<center>
								<h:outputText id="item2" value="#{suspensao.indicativoSuspensao.descricao}"	styleClass="cel-50" />
							</center>
						</h:column>
						<h:column id="col3" headerClass="cel-15">
							<f:facet name="header">
	                            Data da decisão
	                        </f:facet>
							<center>
								<h:outputText id="item4" value="#{suspensao.dataDecisao}"	styleClass="cel-15">
									<f:convertDateTime id="convInicio" type="date" pattern="MM/yyyy" />
								</h:outputText>
							</center>
						</h:column>
						<h:column id="col4" headerClass="cel-15">
							<f:facet name="header">
	                           Indicativo de depósito do montante integral
	                        </f:facet>
							<center>
								<h:outputText id="item5" value="#{suspensao.indicativoDeposito.descricao}" styleClass="cel-15" />
							</center>
						</h:column>
						<h:column id="col5">
	                       	<f:facet name="header">EDITAR</f:facet>
	                       	<ui:fragment rendered="#{suspensao.id != null}">
		                       	<a4j:commandLink id="editar"
		                       				   value="Editar"			                       				 
		                       				   styleClass="ico-editar"
		                       				   oncomplete="Richfaces.showModalPanel('modal');"
		                       				   reRender="modal" >
		                        	<f:setPropertyActionListener target="#{processoESocialFormBean.suspensao}" value="#{suspensao}" />		                       				  
		                        </a4j:commandLink>
	                       	</ui:fragment>
	                    </h:column>				
						
						<h:column id="col6"	>
							<f:facet name="header">EXCLUIR</f:facet>						
							<h:commandLink id="excluirSuspensao" value="Excluir" action="#{processoESocialFormBean.excluirSuspensao}" styleClass="ico-delete"
								onclick="var x= confirm('Deseja realmente excluir o registro?');if(!x){return false;}" >							
								<f:setPropertyActionListener target="#{processoESocialFormBean.suspensao}" value="#{suspensao}" />
							</h:commandLink>
						</h:column>
					
					</rich:dataTable>	
				</div>
				
			</fieldset>			

			<ui:fragment rendered="#{true}">

				<h:commandButton value="Salvar"
					action="#{processoESocialFormBean.salvar}"
					styleClass="bt-padrao fr" />

				<a href="/srh/paginas/tabelas/processoESocialForm.faces"
					class="bt-padrao fr mg-right-10">Limpar</a>

			</ui:fragment>

			<a href="/srh/paginas/tabelas/processoESocialList.faces"
				class="bt-padrao fr mg-right-10">Voltar</a>

		</h:form>
		
        <rich:modalPanel id="modal" resizeable="false" height="320" width="600">					            
        	
			<f:facet name="header" class="header">
            	<span>Editar Suspensão de Exigibilidade</span>
            </f:facet>
        	
        	<h:form id="form2" styleClass="formularios">
        					
				<div class="input-box box-25">
					<label for="">ID</label>
					<div class="conteiner">
						<h:inputText id="idEditar"
							value="#{processoESocialFormBean.suspensao.id}"
							disabled="#{true}" />
					</div>
				</div>
				
				<div class="select-box box-100">
					<label for="">Indicativo de suspensão da exigibilidade</label>
					<div class="conteiner">
						<h:selectOneMenu id="indicativoSuspensaoEditar"	value="#{processoESocialFormBean.suspensao.indicativoSuspensao}">
							<f:selectItems id="comboIndicativoSuspensaoEditar" value="#{processoESocialFormBean.comboIndicativoSuspensao}"
								var="suspensao" itemLabel="#{suspensao.descricao}"
								itemValue="#{suspensao}" />
						</h:selectOneMenu>
					</div>
				</div>
				
				<div class="input-box box-30">
					<label for="">Data da decisão</label>
					<div class="conteiner">
						<h:inputText id="dataDecisaoEditar" name="dataDecisao" styleClass="maskData"
							converter="dateConverter"
							value="#{processoESocialFormBean.suspensao.dataDecisao}"
							maxlength="10" />
					</div>
				</div>
				
				<div class="radios-group box-70">
					<h3>Indicativo de depósito do montante integral</h3>
					<div class="conteiner">
						<div class="radio-box">
						<h:selectOneRadio id="indicativoDepositoEditar" value="#{processoESocialFormBean.suspensao.indicativoDeposito}">
							<f:selectItems id="simNaoEditar" value="#{processoESocialFormBean.simNao}" 
								var="item" itemLabel="#{item.descricao}" itemValue="#{item}" />
						</h:selectOneRadio>
						</div>
					</div>
				</div>						
	
				<div class="modal-actions" style="padding-bottom:0;">						
					<h:commandLink value="Salvar" action="#{processoESocialFormBean.salvarSuspensao}" styleClass="bt-padrao fr">
						<a4j:support event="click" oncomplete="Richfaces.hideModalPanel('modal');"	/>
					</h:commandLink>	
					<a href="#" onclick="Richfaces.hideModalPanel('modal');" class="bt-padrao fr mg-right-15">Cancelar</a>
				</div>					
			
			</h:form>							
		
		</rich:modalPanel>				

	</ui:define>
</ui:composition>
