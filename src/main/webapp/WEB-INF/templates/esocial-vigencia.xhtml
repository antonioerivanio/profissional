<ui:composition 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
	
	<style>
		.duvida-vigencia {
			position: absolute;
		    top: 12px;
		    right: 5px;
		    width: 16px;
		    height: 16px;
		    border-radius: 50%;
		    border: 1px solid #707070;
		    text-align: center;
		    cursor: pointer;
		}
		
		.duvida-vigencia span {
			font-size: 14px;
		    font-weight: bold;
		    color: #707070;
		}
		
		
		.modal p, .modal b, .modal a{
			font-size: 14px;
		}
		
		.modal p{
			padding: 10px;
		}
		
		.modal p > a{
			text-decoration: none;
			font-weight: bold;
			color: #1c5ba7;
		}
	
	</style>
	
	<rich:panel id="fieldset-vigencia">					
		<fieldset class="fl mg-right-15" style="padding-bottom: 0; position: relative;" >
		
			<div 
				class="duvida-vigencia" 
				onclick="#{rich:component('modalInstrucoesVigencia')}.show();" 
				title="Informações sobre o período de vigência"><span>?</span></div>
	
			<legend>Período de Vigência <span class="identificador-esocial">(e)</span></legend>
									
			<ui:fragment rendered="#{!vigencia.vigenciaEditavel}">
			
				<div class="input-box vigencia-width-data">
					<label for="">Início</label>
					<div class="conteiner">
						<h:inputText 
							id="inicioValidade" 
							name="inicioValidade"
							styleClass="maskVigencia" 
							converter="vigenciaConverter"
							value="#{vigencia.inicioValidade}"
							maxlength="7"
							disabled="#{vigencia.vigenciaDesabilitada}"
							autocomplete="off">
							<rich:placeholder value="MM/AAAA" />
						</h:inputText>
					</div>
				</div>
	
				<div class="input-box vigencia-width-data">
					<label for="">Fim</label>
					<div class="conteiner">
						<h:inputText 
							id="fimValidade" 
							name="fimValidade"
							styleClass="maskVigencia" 
							converter="vigenciaConverter"
							value="#{vigencia.fimValidade}"
							maxlength="7"
							disabled="#{vigencia.vigenciaDesabilitada}"
							autocomplete="off">
							<rich:placeholder value="MM/AAAA" />
						</h:inputText>
					</div>
				</div>
			
			</ui:fragment>
			
			<ui:fragment rendered="#{vigencia.vigenciaEditavel}">
			
				<div class="input-box vigencia-width-data">
					<label for="">Novo início</label>
					<div class="conteiner">
						<h:inputText 
							id="inicioNovaValidade" 
							name="inicioNovaValidade"
							styleClass="maskVigencia" 
							converter="vigenciaConverter"
							value="#{vigencia.inicioNovaValidade}"
							maxlength="7"
							autocomplete="off">
							<rich:placeholder value="MM/AAAA" />
						</h:inputText>	
					</div>
				</div>
	
				<div class="input-box vigencia-width-data">
					<label for="">Novo fim</label>
					<div class="conteiner">
						<h:inputText 
							id="fimNovaValidade" 
							name="fimNovaValidade"
							styleClass="maskVigencia" 
							converter="vigenciaConverter"
							value="#{vigencia.fimNovaValidade}"
							maxlength="7"
							autocomplete="off">
							<rich:placeholder value="MM/AAAA" />
						</h:inputText>
					</div>
				</div>						
				
			</ui:fragment>
									
			<ui:fragment rendered="#{vigencia.inicioValidade != null}">
															
				<!-- Botões de alteração -->
				<ui:fragment rendered="#{!vigencia.exclusaoTransmitida()
											and !vigencia.podeCancelarOperacaoAnterior() 
											and !vigencia.vigenciaEditavel}">
					<div class="fl mg-top-19 mg-right-10">
						<a4j:commandLink 
							value="Nova validade" 
							action="#{vigencia.alterarVigencia()}" 
							styleClass="bt-padrao"
							event="click" 
							render="fieldset-vigencia" 
							execute="@this"/>
					</div>
					<div class="fl mg-top-19 mg-right-15">
						<a4j:commandLink 
							value="Excluir" 
							action="#{vigencia.excluirVigencia()}" 
							styleClass="bt-padrao"
							event="click" 
							render="fieldset-vigencia" 
							execute="@this"/>
					</div>
				</ui:fragment>
				
				<ui:fragment rendered="#{!vigencia.exclusaoTransmitida()
											and (vigencia.podeCancelarOperacaoAnterior() 
													or vigencia.vigenciaEditavel)}">
					<div class="fl mg-top-19 mg-right-10">
						<a4j:commandLink 
							value="Cancelar" 
							action="#{vigencia.apagaAlteracao()}" 
							styleClass="bt-padrao"
							event="click" 
							render="fieldset-vigencia" 
							execute="@this"/>	
					</div>
				</ui:fragment>
				
				<ui:fragment rendered="#{vigencia.exclusaoTransmitida()}">
					<div class="fl mg-top-19 mg-right-10">
						<a4j:commandLink 
							value="Incluir novamente" 
							action="#{vigencia.incluirNovamente()}" 
							styleClass="bt-padrao"
							event="click" 
							render="fieldset-vigencia" 
							execute="@this"/>	
					</div>
				</ui:fragment>						
				
				<!-- Mensagens de vigências anteriores -->
				<ui:fragment rendered="#{vigencia.vigenciaEditavel}">
					<div class="fl vigencia-msg-alerta">
						<h:outputText
							id="alterarVigenciaAnterior" 
							value="Vigência anterior: " />
						<h:outputText
							id="alterarVigenciaInicioValidade" 
							converter="vigenciaConverter"
							value="#{vigencia.inicioValidade}" />
						<ui:fragment rendered="#{vigencia.fimValidade != null}">
							<h:outputText 
								id="alterarVigenciaAFimValidade"
								value=" à " /> 
							<h:outputText
								id="alterarVigenciaFimValidade" 
								converter="vigenciaConverter"
								value="#{vigencia.fimValidade}" />	
						</ui:fragment>			  
					</div>
				</ui:fragment>
				
				<!-- Mensagens de exclusão -->
				<ui:fragment rendered="#{vigencia.excluido}">
					<div class="fl vigencia-msg-alerta">									
						<h:outputText 
							id="excluidaENaoTransmitida" 
							value="Foi solicitada a exclusão da vigência atual." 
							rendered="#{!vigencia.transmitido}" />																	
						<h:outputText 
							id="excluidaETransmitida" 
							value="Foi transmitida a exclusão da vigência atual." 
							rendered="#{vigencia.transmitido}" />
					</div>
				</ui:fragment>
		
			</ui:fragment>
		
		</fieldset>
	</rich:panel>
	
	<rich:popupPanel id="modalInstrucoesVigencia" styleClass="modal" resizeable="false" height="280" width="500">					            
        	
		<f:facet name="header" class="header">
	    	<span>Informações sobre o período de vigência</span>
	    </f:facet>
	    
	    <p>Para enviar estes dados ao eSocial, preencha obrigatoriamente a data de <b>INÍCIO</b> do Período de Validade.</p> 
       	<p>Caso este cadastro não deva ser enviado ao eSocial, basta não preencher as datas de validade.</p>
		<p>
			Para mais informações sobre a exclusão e a utilização da data fim, veja o 
			<a href="http://portal.esocial.gov.br/institucional/documentacao-tecnica" target="_blank">
				Manual de Orientação do eSocial</a>.
		</p>
       	
       	<div class="modal-actions" style="padding-bottom:0;">
			<a href="#" onclick="#{rich:component('modalInstrucoesVigencia')}.hide();" class="bt-padrao fr mg-right-15">OK</a>
		</div>						
	
	</rich:popupPanel>
	
</ui:composition>